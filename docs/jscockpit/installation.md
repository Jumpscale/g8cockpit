# Installation

There are two ways of install a new Cockpit:

- Using the **Cockpit Deployer Chatbot** on Telegram
- Using AtYourService


## Using Cockpit Deployer Chatbot

An instance of the **Cockpit Deployer Chatbot** is active as `@g8cockpitbot` on Telegram.

You can also install your own instance by following the [Cockpit Deployer Chartbot installation instructions](../deployer_bot/installation.md).

Follow the [Cockpit Deployer Chartbot usage instructions](../deployer_bot/usage.md) in order to install your Cockpit.
After you chat with the bot. He will send you the information of your cockpit:
- the URL to reach the portal
- IP address and ssh command to connect to the VM running the cockpit
- sshkey you need to use to have access to the vm.

## Using AtYourService

If you have a system with JumpScale installed, you can also use AtYourService to create a new Cockpit.

- Create a AYS service repository:

```bash
mkdir /opt/code/ays_cockpit
mkdir /opt/code/ays_cockpit/blueprints
touch /opt/code/ays_cockpit/.ays
```

- Replace the values in this blueprint:

```yaml
g8client__main:
  g8.url: '{g8_url}'
  g8.login: '{g8_login}'
  g8.password: '{g8_password}'
  g8.account: '{g8_account}'

cockpit.g8__pilot:
  telegram.token: '{telegram_token}'
  cockpit.name: '{cockpit_name}'
  dns.sshkey: '{dns_sshkey}'
  dns.domain: '{dns_domain}'
  oauth.client_secret: '{oauth_secret}'
  oauth.client_id: '{oauth_id}'
  oauth.organization: '{oauth_organization}'
  oauth.jwt_key: '{oauth_jwtkey}'
```

Description of the values:
- **g8.url**: URL of the G8 where you want to deploy the cockpit, e.g. `be-scale-1.demo.greenitglobe.com`
- **g8.login**: Username of your user account on the G8
- **g8.password**: Password of your user account on the G8
- **g8.account**: Name of your (cloud) account on the G8; if not specified the username specified in g8.login will be used 
- **telegram.token**: API token from Telegram, as received from @botfather when you create a new bot
- **cockpit.name**: Can be anything
- **dns.sshkey**: Path to the sshkey of the DNS server; see https://gig.gitbooks.io/ovcdoc_internal/content/InternalIT/internal_it.html for more details about DNS infrastructure
- **dns.domain**: Sub domain you want for your cockpit, e.g. if you choose `mycockpit`, the domain will be `mycockpit.barcelona.aydo.com`
- **oauth.client_secret**: Client secret for your organization as generated by ItsYou.online
- **oauth.client_id**: Client ID for your Organization as set on ItsYou.online
- **oauth.organization**: Name of the organization of your Cockpit
- **oauth.jwt_key**: ItsYou.online public key for JWT signing; see https://github.com/itsyouonline/identityserver/blob/master/docs/oauth2/jwt.md for more details

- Copy the blueprint into the blueprints subdirectory:

```bash
cp bp.yml /opt/code/ays_cockpit/blueprints
```

- Init and install the blueprint:

```bash
cd /opt/code/ays_cockpit
ays init
ays install
```

## Allow the cockpit to push to your Github repository

The last think you need to do is to do to fulling configure your cockpit is to create a deploy key on your github repository where the AYS services will be saved.
To do that:
- go on the setting page of the github repository you specify during installation.
- click on `deploy keys` tab
- Add a deploy key.
- copy the content of the public key that you can find in the portal information page.